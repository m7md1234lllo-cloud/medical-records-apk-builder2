{% extends "base.html" %}

{% block title %}Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©{% endblock %}

{% block content %}
<div class="form-container">
    <h2>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</h2>
    <p style="color: #666; margin-bottom: 2rem;">Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø©</p>
    
    <form id="settingsForm">
        <div class="form-section">
            <h3>ğŸ¥ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</h3>
            
            <div class="form-group">
                <label for="clinic_name">Ø§Ø³Ù… Ø§Ù„Ø¹ÙŠØ§Ø¯Ø© *</label>
                <div class="input-with-voice">
                    <input type="text" id="clinic_name" name="clinic_name" 
                           value="{{ settings['clinic_name'] or 'Ø§Ù„Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ø¨ÙŠØ©' }}" required>
                    <button type="button" class="voice-btn" data-target="clinic_name">ğŸ¤</button>
                </div>
            </div>

            <div class="form-group">
                <label for="header_text">Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªØ±ÙˆÙŠØ³Ø©)</label>
                <div class="input-with-voice">
                    <input type="text" id="header_text" name="header_text" 
                           value="{{ settings['header_text'] or 'Ø¹ÙŠØ§Ø¯Ø© Ø·Ø¨ÙŠØ© Ù…ØªØ®ØµØµØ©' }}">
                    <button type="button" class="voice-btn" data-target="header_text">ğŸ¤</button>
                </div>
            </div>

            <div class="form-group">
                <label for="clinic_address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                <div class="input-with-voice">
                    <textarea id="clinic_address" name="clinic_address" rows="2">{{ settings['clinic_address'] or '' }}</textarea>
                    <button type="button" class="voice-btn" data-target="clinic_address">ğŸ¤</button>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="clinic_phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <div class="input-with-voice">
                        <input type="tel" id="clinic_phone" name="clinic_phone" 
                               value="{{ settings['clinic_phone'] or '' }}">
                        <button type="button" class="voice-btn" data-target="clinic_phone">ğŸ¤</button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="clinic_email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="clinic_email" name="clinic_email" 
                           value="{{ settings['clinic_email'] or '' }}">
                </div>
            </div>

            <div class="form-group">
                <label for="footer_text">Ø§Ù„Ù†Øµ Ø§Ù„Ø³ÙÙ„ÙŠ (ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªØ°ÙŠÙŠÙ„)</label>
                <div class="input-with-voice">
                    <input type="text" id="footer_text" name="footer_text" 
                           value="{{ settings['footer_text'] or 'Ù†ØªÙ…Ù†Ù‰ Ù„ÙƒÙ… Ø¯ÙˆØ§Ù… Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø¹Ø§ÙÙŠØ©' }}">
                    <button type="button" class="voice-btn" data-target="footer_text">ğŸ¤</button>
                </div>
            </div>
        </div>

        <div class="info-box" style="background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%); padding: 1.5rem; border-radius: 10px; margin: 2rem 0; border-right: 5px solid #17a2b8;">
            <strong style="color: #0c5460; display: block; margin-bottom: 0.5rem;">ğŸ’¡ Ù†ØµÙŠØ­Ø©:</strong>
            <p style="color: #0c5460; margin: 0;">Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³ØªØ¸Ù‡Ø± ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹Ø© ÙˆÙ…Ù„ÙØ§Øª PDF Ø§Ù„ØªÙŠ ÙŠØªÙ… ØªØµØ¯ÙŠØ±Ù‡Ø§. ØªØ£ÙƒØ¯ Ù…Ù† Ø¯Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">Ø¥Ù„ØºØ§Ø¡</a>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/voice.js') }}"></script>
<script>
document.getElementById('settingsForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = {
        clinic_name: document.getElementById('clinic_name').value,
        header_text: document.getElementById('header_text').value,
        clinic_address: document.getElementById('clinic_address').value,
        clinic_phone: document.getElementById('clinic_phone').value,
        clinic_email: document.getElementById('clinic_email').value,
        footer_text: document.getElementById('footer_text').value
    };
    
    try {
        const response = await fetch('/settings', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        });
        
        const result = await response.json();
        
        if (result.success) {
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
            window.location.reload();
        }
    } catch (error) {
        alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
        console.error(error);
    }
});
</script>
{% endblock %}
